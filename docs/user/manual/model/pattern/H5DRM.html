

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>3.1.10.4. H5DRM Pattern &mdash; OpenSees Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="3.1.11. Damping Commands" href="../damping.html" />
    <link rel="prev" title="3.1.10.3.2. Imposed Motion Command" href="groundmotion/imposedMotion.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html">
          

          
            
            <img src="../../../../_static/OpenSeesLogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Applications for Users</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../interpreters.html">1. OpenSees Interpreters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">2. Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../userManual.html">3. Command Manual</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../modelCommands.html">3.1. Modelling Commands</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../model.html">3.1.1. Model Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../node.html">3.1.2. Node Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spConstraints.html">3.1.3. SP_Constraint Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mpConstraints.html">3.1.4. MP_Constraint Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../material/uniaxialMaterial.html">3.1.5. uniaxialMaterial Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../material/ndMaterial.html">3.1.6. nDMaterial Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../material/section.html">3.1.7. section Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../element.html">3.1.8. Element Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../timeSeries.html">3.1.9. Time Series Command</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../pattern.html">3.1.10. Pattern Command</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="plainPattern.html">3.1.10.1. Plain Pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="uniformExcitationPattern.html">3.1.10.2. Uniform Excitation</a></li>
<li class="toctree-l4"><a class="reference internal" href="multiSupportPattern.html">3.1.10.3. Multisupport Excitation</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">3.1.10.4. H5DRM Pattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../damping.html">3.1.11. Damping Commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../analysisCommands.html">3.2. Analysis Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../outputCommands.html">3.3. Output Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../materialCommands.html">3.4. Material Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../miscCommands.html">3.5. Misc. Commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../userExamples.html">4. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../messageBoard.html">5. Questions, Bugs &amp; Feature Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/license.html">6. Copyright and License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Framework for Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/sourceCode.html">1. Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/build.html">2. Building Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/references.html">3. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/extend.html">4. Extending Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/contribute.html">5. Contributing Code &amp; Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/issues.html">6. Issues</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">OpenSees Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../userManual.html"><span class="section-number">3. </span>Command Manual</a> &raquo;</li>
        
          <li><a href="../../modelCommands.html"><span class="section-number">3.1. </span>Modelling Commands</a> &raquo;</li>
        
          <li><a href="../pattern.html"><span class="section-number">3.1.10. </span>Pattern Command</a> &raquo;</li>
        
      <li><span class="section-number">3.1.10.4. </span>H5DRM Pattern</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/user/manual/model/pattern/H5DRM.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="h5drm-pattern">
<span id="multisupportexcitation"></span><h1><span class="section-number">3.1.10.4. </span>H5DRM Pattern<a class="headerlink" href="#h5drm-pattern" title="Permalink to this headline">Â¶</a></h1>
<p>Perform earthquake time-history analysis using the domain reduction method (DRM).</p>
<p>The H5DRM pattern implements the DRM using the H5DRM data format. It directly reads the dataset, performs node matching, identifies the connecting elements, and applies the loads and (linear) interpolation of displacements and accelerations in time.</p>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">pattern</span> <span class="pre">H5DRM</span> <span class="pre">$patternTag</span> <span class="pre">&quot;/path/to/H5DRM/dataset&quot;</span> <span class="pre">$factor</span> <span class="pre">$crd_scale</span> <span class="pre">$distance_tolerance</span> <span class="pre">$do_coordinate_transformation</span> <span class="pre">$T00</span> <span class="pre">$T01</span> <span class="pre">$T02</span> <span class="pre">$T10</span> <span class="pre">$T11</span> <span class="pre">$T12</span> <span class="pre">$T20</span> <span class="pre">$T21</span> <span class="pre">$T22</span> <span class="pre">$x00</span> <span class="pre">$x01</span> <span class="pre">$x02</span></span></dt>
<dd></dd></dl>

<p>All paramters are required at this point!</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>$factor</p></td>
<td><p><em>float</em></p></td>
<td><p>multiply DRM dataset displacements and accelerations by this value</p></td>
</tr>
<tr class="row-odd"><td><p>$crd_scale</p></td>
<td><p><em>float</em></p></td>
<td><p>multiply (x, y, z) coordinates of dataset points by this value (typically for unit change between dataset and FE model)</p></td>
</tr>
<tr class="row-even"><td><p>$distance_tolerance</p></td>
<td><p><em>float</em></p></td>
<td><p>tolerance for DRM point to FE mesh matching. Set to a size similar to the node distance near the DRM boundary.</p></td>
</tr>
<tr class="row-odd"><td><p>$do_coordinate_transformation</p></td>
<td><p><em>integer</em></p></td>
<td><p>=1 apply a coordinate transformation to the (x, y, z) coordinates of dataset points before matching</p></td>
</tr>
<tr class="row-even"><td><p>$T00</p></td>
<td><p><em>float</em></p></td>
<td><p>00 component of the transformation matrix</p></td>
</tr>
<tr class="row-odd"><td><p>$T01</p></td>
<td><p><em>float</em></p></td>
<td><p>01 component of the transformation matrix</p></td>
</tr>
<tr class="row-even"><td><p>$T02</p></td>
<td><p><em>float</em></p></td>
<td><p>02 component of the transformation matrix</p></td>
</tr>
<tr class="row-odd"><td><p>$T10</p></td>
<td><p><em>float</em></p></td>
<td><p>10 component of the transformation matrix</p></td>
</tr>
<tr class="row-even"><td><p>$T11</p></td>
<td><p><em>float</em></p></td>
<td><p>11 component of the transformation matrix</p></td>
</tr>
<tr class="row-odd"><td><p>$T12</p></td>
<td><p><em>float</em></p></td>
<td><p>12 component of the transformation matrix</p></td>
</tr>
<tr class="row-even"><td><p>$T20</p></td>
<td><p><em>float</em></p></td>
<td><p>20 component of the transformation matrix</p></td>
</tr>
<tr class="row-odd"><td><p>$T21</p></td>
<td><p><em>float</em></p></td>
<td><p>21 component of the transformation matrix</p></td>
</tr>
<tr class="row-even"><td><p>$T22</p></td>
<td><p><em>float</em></p></td>
<td><p>22 component of the transformation matrix</p></td>
</tr>
<tr class="row-odd"><td><p>$x00</p></td>
<td><p><em>float</em></p></td>
<td><p>x location of the top-center node of the DRM Box after transformation</p></td>
</tr>
<tr class="row-even"><td><p>$x01</p></td>
<td><p><em>float</em></p></td>
<td><p>y location of the top-center node of the DRM Box after transformation</p></td>
</tr>
<tr class="row-odd"><td><p>$x02</p></td>
<td><p><em>float</em></p></td>
<td><p>z location of the top-center node of the DRM Box after transformation</p></td>
</tr>
</tbody>
</table>
<p>This load pattern takes input from DRM datasets formatted using the H5DRM data-format specified in [1], which uses the HDF5 library for IO. These datasets can be produced natively for 1-D crust models by the <a class="reference external" href="https://shakermaker.readthedocs.io/en/latest/">ShakerMaker</a> python library (it was designed to do this). Otherwise, the HDF5 format on which H5DRM is based is simple enough that output from other seismological software can be easily cast into this format (in python use the <code class="code docutils literal notranslate"><span class="pre">h5py</span></code> library). Hopefully, other programs will provide native support for <cite>H5DRM</cite> in the future.</p>
<div class="admonition-about-the-coordinate-transformation admonition">
<p class="admonition-title">About the coordinate transformation</p>
<p>Because the H5DRM dataset format is designed to facilitate the sharing of datasets for DRM analysis, the coordinate systems with which the DRM boundary points are represented are generally unrelated to those of the local-scale (OpenSees FEM) model. Thus, we provide a means for transforming between coordinates systems in the implementation of the H5DRM load pattern, which is applied to the DRM boundary point coordinates <em>before the node matching</em>. This transformation is described in the following image.</p>
<div class="align-center figure">
<img alt="../../../../_images/drm-doc-01-transformation.png" src="../../../../_images/drm-doc-01-transformation.png" />
</div>
</div>
<div class="admonition-example-free-field-response admonition">
<p class="admonition-title">Example: Free field response</p>
<div class="line-block">
<div class="line-block">
<div class="line">In this example, the free-field site response to motions input with DRM are computed. When the simulation conditions used to develop the DRM motion dataset match those of the local-site, then there are (approximately) no out-going waves in the model to be damped. This constitutes a basic check or validation to both the DRM datset and the local-scale FEM model, which is useful to perform before any other analysis with DRM.</div>
<div class="line"><br /></div>
</div>
<div class="line">See this <a class="reference external" href="https://youtu.be/4BxzkkUzYok">video explanation</a>.</div>
<div class="line"><br /></div>
</div>
<embed><center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/4BxzkkUzYok" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</embed></center><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line-block">
<div class="line"><strong>Model conditions</strong>:</div>
</div>
</div>
<blockquote>
<div><blockquote>
<div><div class="align-center figure">
<img alt="../../../../_images/drm-example-01-mesh.png" src="../../../../_images/drm-example-01-mesh.png" />
</div>
</div></blockquote>
<ul>
<li><p>Local site conditions are <span class="math notranslate nohighlight">\(V_s = 200 \frac{m}{s}\)</span>, <span class="math notranslate nohighlight">\(\nu = 0.25\)</span>,  <span class="math notranslate nohighlight">\(\rho = 2000 \frac{kg}{m^3}\)</span> for the top 20m which covers the complete FEM model and DRM dataset.</p></li>
<li><p>Motions generated with ShakerMaker with this python script: <a class="reference external" href="https://www.dropbox.com/s/wb46sanjeq5ub27/drm-example-santiago-1.py?dl=1">drm-example-santiago-1.py?</a></p></li>
<li><p>H5DRM dataset can be downloaded from here: <a class="reference external" href="https://www.dropbox.com/s/t4qxfa5k7u54eaw/santiago1.zip?dl=1">santiago1.zip?</a></p></li>
<li><p>DRM motions come from a point source 10km away in the X direction (of the FEM model) and 3 km deep. The point source dips at an angle of 30Â°, which means that only motions in the X-Z planes occur due to the location of the site. The following is the expected surface response at the site where DRM motions are recorded (in the FEM model X is east, Y is north and Z is up):</p>
<blockquote>
<div><div class="align-center figure">
<img alt="../../../../_images/drm-example-02-site-motions.png" src="../../../../_images/drm-example-02-site-motions.png" />
</div>
</div></blockquote>
</li>
<li><p>The source time-funciton is a Brune source with a corner frequency of <span class="math notranslate nohighlight">\(f_0 = 4 Hz\)</span>.</p></li>
<li><p>The cutoff frequency for the mesh is set to <span class="math notranslate nohighlight">\(f_{max} = 10Hz\)</span>, which results in a required mesh size of <span class="math notranslate nohighlight">\(dx = 1m\)</span> and a time-step of <span class="math notranslate nohighlight">\(dt = 0.005\)</span>.</p></li>
<li><p>DRM box size is <span class="math notranslate nohighlight">\(40m \times 40m \times 15m\)</span></p></li>
<li><p>The interior of the DRM box is set to have a Rayleigh-damping of 0.1% while the exterior is set to 20%, this eliminates unresolved frequencies (and out-going waves for non free-field models).</p></li>
<li><p>The OpenSees model was prepared in STKO for single-processor analysis and also multi-processor analysis (OpenSeesMP). You can download the TCL files of the model in any version here:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 Partition (Single-processor OpenSees) [<a class="reference external" href="https://www.dropbox.com/s/c1o09mtoysyw7mc/model-1-partition.zip?dl=1">download</a>]</p></li>
<li><p>2 Partitions (OpenSeesMP)[<a class="reference external" href="https://www.dropbox.com/s/xdnh75eqfio9u1p/model-2-partitions.zip?dl=1">download</a>]</p></li>
<li><p>4 Partitions (OpenSeesMP)[<a class="reference external" href="https://www.dropbox.com/s/pt6l4io3eb4xlql/model-4-partitions.zip?dl=1">download</a>]</p></li>
<li><p>8 Partitions (OpenSeesMP)[<a class="reference external" href="https://www.dropbox.com/s/f38itubyu5tuxt4/model-8-partitions.zip?dl=1">download</a>]</p></li>
<li><p>16 Partitions  (OpenSeesMP)[<a class="reference external" href="https://www.dropbox.com/s/njx90ipbh04ah46/model-16-partitions.zip?dl=1">download</a>]</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>By looking in <code class="code docutils literal notranslate"><span class="pre">analysis-steps.tcl</span></code> for any of the above examples, you can see the TCL line for the H5DRM load pattern is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pattern</span> <span class="n">H5DRM</span> <span class="mi">3</span> <span class="s2">&quot;C:/path/jaabe/Documents/DRM-example/santiago1.h5drm&quot;</span> <span class="mf">1.0</span> <span class="mf">1000.0</span> <span class="mf">0.001</span> <span class="mi">1</span>   <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="o">-</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">1.0</span>   <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p>Code Developed by: <a class="reference external" href="www.joseabell.com">JosÃ© Antonio Abell</a> (UANDES). For issues, start a new issue on the <a class="reference external" href="https://github.com/OpenSees/OpenSees">OpenSees github repo</a> and tag me (&#64;jaabell).</p>
<dl class="citation">
<dt class="label" id="references"><span class="brackets">References</span></dt>
<dd><p>[1] <a class="reference external" href="www.joseabell.com">Jose A. Abell.</a>, Jorge G.F. Crempien, MatÃ­as Recabarren ShakerMaker: A framework that simplifies the simulation of seismic ground-motions. SoftwareX. <a class="reference external" href="https://doi.org/10.1016/j.softx.2021.100911">https://doi.org/10.1016/j.softx.2021.100911</a></p>
</dd>
</dl>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, The Regents of the University of California.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-2431545-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>